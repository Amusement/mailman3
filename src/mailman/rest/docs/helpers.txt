================
REST API helpers
================

There are a number of helpers that make building out the REST API easier.


Resource paths
==============

For example, most resources don't have to worry about where they are rooted.
They only need to know where they are relative to the root URI, and this
function can return them the full path to the resource.

    >>> from mailman.rest.helpers import path_to
    >>> print path_to('system')
    http://localhost:8001/3.0/system

Parameters like the scheme, host, port, and API version number can be set in
the configuration file.

    >>> config.push('helpers', """
    ... [webservice]
    ... hostname: geddy
    ... port: 2112
    ... use_https: yes
    ... api_version: 4.2
    ... """)

    >>> print path_to('system')
    https://geddy:2112/4.2/system


Etags
=====

HTTP etags are a way for clients to decide whether their copy of a resource
has changed or not.  Mailman's REST API calculates this in a cheap and dirty
way.  Pass in the dictionary representing the resource and that dictionary
gets modified to contain the etag under the `http_etag` key.

    >>> from mailman.rest.helpers import etag
    >>> resource = dict(geddy='bass', alex='guitar', neil='drums')
    >>> json_data = etag(resource)
    >>> print resource['http_etag']
    "43942176d8d5bb4414ccf35e2720ccd5251e66da"

For convenience, the etag function also returns the JSON representation of the
dictionary after tagging, since that's almost always what you want.

    >>> import json
    >>> data = json.loads(json_data)

    # This is pretty close to what we want, so it's convenient to use.
    >>> dump_msgdata(data)
    alex     : guitar
    geddy    : bass
    http_etag: "43942176d8d5bb4414ccf35e2720ccd5251e66da"
    neil     : drums
